{% extends 'base.html.twig' %}

{% block title %}Liste de Tâches{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="//cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css">
{% endblock %}

{% block body %}
    <div class="container mt-5">
     <a href="{{ path('task_create')}}" class="btn btn-primary">{{ "button.add"|trans}}</a>
        <table class="table table-striped table-bordered" id="taskTable">
            <thead>
                <th>id</th>
                <th>Nom</th>
                <th>Date effective</th>
                <th>Catégorie</th>
                <th></th>
                <th></th>
                <th></th>
            </thead>
            <tbody>
                {% if tasks is defined %}
                    {% for task in tasks %}
                        <tr>
                            <th scopre="row">{{ task.id }}</th>
                            <td class="clickable" data-id="{{path('task_detail',{'id':task.id})}}">{{ task.name }}</td>
                            <td>{{ task.dueAt | date('date'|trans)}}</td>
                            <td>{{ task.tag.name }}</td>
                            <td><a href="{{ path('task_email',{'id': task.id})}}"class="btn btn-primary ">Email</a></td>
                            <td><a href="{{ path('task_update', {'id':task.id})}}" class="btn btn-success">{{ "button.update"|trans}}</a>
                            </td>
                            <td><a href="{{ path('task_delete', {'id':task.id})}}" class="btn btn-danger">{{ "button.delete"|trans}}</a>
                            </td>
                        </tr>   
                    {% endfor %}
                {% endif %}         
            </tbody>
        </table>
    </div>
{% block javascripts %}
    <script src="//cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
<script>
		if(window.location.href.includes('fr')){
			$(document).ready(function () {
				$('#tasksTable').DataTable( {
			"language": {
				"url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json"
				}
    		});
		});
		} else {
					$(document).ready(function () {
            $('#tasksTable').DataTable( {
        "language": {
            "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/English.json"
				}
			});
		});
		}
</script>
<script>
$(".clickable").click(function(e){
    //const idcatch = document.querySelector("#clickable")
    $valeur= e.currentTarget.getAttribute("data-id");
    document.location=$valeur;
    return $valeur; });
</script>
{% endblock %}
    

{% endblock %}
