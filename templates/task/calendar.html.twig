{% extends 'base.html.twig' %}
{% block body %}
	<div class="container">
		{% include '@Calendar/calendar.html' %}
	</div>

    {# MODAL #}
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Informations sur la tâche</h5>
            <button type="button" id="btnClose" class="close" data-dismiss="modal" aria-label="Close" onclick="$('#exampleModalCenter').modal('hide');">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>

{% endblock %}
{% block stylesheets %}
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/core@4.1.0/main.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@4.1.0/
		main.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/timegrid@4.1.0/
		main.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap@4.2.0/
	main.min.css">
{% endblock %}
{% block javascripts %}
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core@4.1.0/main.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/interaction@4.1.0/main.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@4.1.0/main.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/timegrid@4.1.0/main.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap@4.2.0/main.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', () => {
    var calendarEl = document.getElementById('calendar-holder');

    var calendar = new FullCalendar.Calendar(calendarEl, {
        defaultView: 'dayGridMonth',
        editable: true,
        eventSources: [
            {
                url: "{{ path('fc_load_events') }}",
                method: "POST",
                extraParams: {
                    filters: JSON.stringify({})
                },
                success: () => { console.log(event);},
                failure: () => { console.log("error");},
            },
        ],
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay',
        },
        plugins: [ 'interaction', 'dayGrid', 'timeGrid' ],
        timeZone: 'UTC',

        // Handle the click on the task 
        eventClick: function(info) {
        console.log(info.event); // DEBUG

        // Récupère l'élèment html pour y afficher les informations.
            var text = document.getElementsByClassName('modal-body');
            text[0].innerHTML = "ID: " + info.event.id 
                                + '<br><br> Name: ' + info.event.title
                                + '<br><br> Début: ' + info.event.extendedProps.beginAt.date
                                + '<br><br> Fin: ' + info.event.extendedProps.endAt.date
                                + '<br><br> Description: ' + info.event.extendedProps.fulltext;

          // Appel du modal lors du clique sur la tâche.
          $('#exampleModalCenter').modal('show');
        }

    });
    calendar.render();
});
	</script>

{% endblock %}
